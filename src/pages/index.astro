---
import Header from '../components/Header.astro';

const posts = await Astro.glob('./journal/*.md');
const sortedPosts = posts.sort((a, b) => 
  new Date(b.frontmatter.pubDate).valueOf() - new Date(a.frontmatter.pubDate).valueOf()
);
---

<html lang="ja">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width" />
		<title>Tomohiro Ogawa</title>
		
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500&family=IBM+Plex+Sans+JP:wght@300;400;600&display=swap" rel="stylesheet">

		<style>
			* { box-sizing: border-box; }
			html { scrollbar-gutter: stable; }
			
			body {
				font-family: "IBM Plex Sans JP", sans-serif;
				font-weight: 400;
				font-feature-settings: "palt";
				background-color: #fff;
				color: #111;
				margin: 0;
				display: flex;
				justify-content: center;
				min-height: 100vh;
			}

			.grid-container {
				width: 100%;
				max-width: 720px;
				padding: 6rem 2rem;
				display: flex;
				flex-direction: column;
			}

			ul {
				list-style: none;
				padding: 0;
				margin: 0;
			}

			.entry {
				margin-bottom: 4rem; /* 記事ごとの間隔を広く取る */
				display: flex;
				flex-direction: column;
			}

			.meta {
				font-family: "IBM Plex Mono", monospace;
				font-size: 0.75rem;
				color: #888;
				margin-bottom: 0.6rem;
				display: flex;
				gap: 1rem;
			}

			.title-link {
				display: block;
				text-decoration: none;
				color: #111;
				font-size: 1.4rem; /* タイトルを少し大きく */
				font-weight: 600;
				line-height: 1.3;
				letter-spacing: 0.02em;
				margin-bottom: 1rem; /* Descriptionとの間隔 */
				transition: opacity 0.2s;
			}
			.title-link:hover { opacity: 0.6; }

			/* 修正: Description as Metadata */
			.description {
				font-family: "IBM Plex Mono", monospace; /* モノスペース */
				font-size: 0.85rem;
				color: #555; /* #666より少し濃く */
				line-height: 1.7;
				margin: 0;
				/* 字間を少し空けて、コードのように見せる */
				letter-spacing: 0.01em; 
			}
		</style>
	</head>
	<body>
		<div class="grid-container">
			<Header activeNav="journal" />

			<main>
				<ul>
					{sortedPosts.map((post, index) => {
						const entryNumber = String(sortedPosts.length - index).padStart(3, '0');
						return (
							<li class="entry">
								<div class="meta">
									<span>#{entryNumber}</span>
									<time datetime={post.frontmatter.pubDate}>
										{new Date(post.frontmatter.pubDate).toLocaleDateString('en-CA')}
									</time>
								</div>
								<a href={post.url} class="title-link">
									{post.frontmatter.title}
								</a>
								{post.frontmatter.description && (
									<p class="description">
										{post.frontmatter.description}
									</p>
								)}
							</li>
						)
					})}
				</ul>
			</main>
		</div>
	</body>
</html>